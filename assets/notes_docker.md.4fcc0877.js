import{_ as n,c as o,a as s,b as e,t as p,d as t,o as c}from"./app.b68c4d44.js";const x='{"title":"docker\u76F8\u5173\u95EE\u9898","description":"","frontmatter":{"title":"docker\u76F8\u5173\u95EE\u9898"},"headers":[{"level":2,"title":"\u4E00\u4E36 ubuntu \u5B89\u88C5","slug":"\u4E00\u4E36-ubuntu-\u5B89\u88C5"},{"level":2,"title":"\u4E8C\u4E36\u5E38\u7528\u547D\u4EE4","slug":"\u4E8C\u4E36\u5E38\u7528\u547D\u4EE4"},{"level":2,"title":"\u4E09\u4E36Dockerfile \u76F8\u5173\u64CD\u4F5C","slug":"\u4E09\u4E36dockerfile-\u76F8\u5173\u64CD\u4F5C"},{"level":2,"title":"\u56DB\u4E36\u6784\u5EFA\u9879\u76EE","slug":"\u56DB\u4E36\u6784\u5EFA\u9879\u76EE"},{"level":2,"title":"\u4E94\u4E36 \u955C\u50CF","slug":"\u4E94\u4E36-\u955C\u50CF"},{"level":2,"title":"\u4E94\u4E36docker \u76F8\u5173\u95EE\u9898","slug":"\u4E94\u4E36docker-\u76F8\u5173\u95EE\u9898"}],"relativePath":"notes/docker.md"}',l={},r={id:"frontmatter-title",tabindex:"-1"},i=s("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),k=t(`<h2 id="\u4E00\u4E36-ubuntu-\u5B89\u88C5" tabindex="-1">\u4E00\u4E36 ubuntu \u5B89\u88C5 <a class="header-anchor" href="#\u4E00\u4E36-ubuntu-\u5B89\u88C5" aria-hidden="true">#</a></h2><ul><li>\u5378\u8F7D\u65E7\u7248\u672C docker</li></ul><div class="language-go"><pre><code>sudo apt<span class="token operator">-</span>get remove docker docker<span class="token operator">-</span>engine docker<span class="token punctuation">.</span>io containerd runc
</code></pre></div><ul><li>\u66F4\u65B0 apt-get \u5E93</li></ul><div class="language-go"><pre><code>sudo apt<span class="token operator">-</span>get update
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">\u8BF4\u660E</p><p>\u5982\u679C\u63D0\u793A <code>Could not get lock /var/lib/dpkg/lock-frontend. It is held by process 154972 (apt-get)</code> \u8BF4\u660E\u4F60\u4E0A\u6B21\u6709\u4F7F\u7528 <code>apt</code> \u6216\u8005 <code>apt-get</code> \u5BFC\u81F4\u9501\u4F4F\u4E86\uFF0C\u4F7F\u7528 <code>sudo killall apt-get apt</code> \u5F3A\u5236\u6740\u6B7B\u8FD9\u4E24\u4E2A\u8FDB\u7A0B</p></div><ul><li>\u5B89\u88C5\u5305\u4EE5\u5141\u8BB8 apt \u901A\u8FC7 HTTPS \u4F7F\u7528\u5B58\u50A8\u5E93</li></ul><div class="language-go"><pre><code>sudo apt<span class="token operator">-</span>get install ca<span class="token operator">-</span>certificates curl gnupg lsb<span class="token operator">-</span>release
</code></pre></div><ul><li>\u6DFB\u52A0 docker \u5B98\u65B9 GPG \u79D8\u94A5</li></ul><div class="language-go"><pre><code>curl <span class="token operator">-</span>fsSL https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>download<span class="token punctuation">.</span>docker<span class="token punctuation">.</span>com<span class="token operator">/</span>linux<span class="token operator">/</span>ubuntu<span class="token operator">/</span>gpg <span class="token operator">|</span> sudo gpg <span class="token operator">--</span>dearmor <span class="token operator">-</span>o <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>keyrings<span class="token operator">/</span>docker<span class="token operator">-</span>archive<span class="token operator">-</span>keyring<span class="token punctuation">.</span>gpg
</code></pre></div><ul><li>\u8BBE\u7F6E\u7A33\u5B9A\u5B58\u50A8\u5E93</li></ul><div class="language-go"><pre><code>echo \\
  &quot;deb <span class="token punctuation">[</span>arch<span class="token operator">=</span>$<span class="token punctuation">(</span>dpkg <span class="token operator">--</span><span class="token builtin">print</span><span class="token operator">-</span>architecture<span class="token punctuation">)</span> signed<span class="token operator">-</span>by<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>keyrings<span class="token operator">/</span>docker<span class="token operator">-</span>archive<span class="token operator">-</span>keyring<span class="token punctuation">.</span>gpg<span class="token punctuation">]</span> https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>download<span class="token punctuation">.</span>docker<span class="token punctuation">.</span>com<span class="token operator">/</span>linux<span class="token operator">/</span>ubuntu \\
  $<span class="token punctuation">(</span>lsb_release <span class="token operator">-</span>cs<span class="token punctuation">)</span> stable&quot; <span class="token operator">|</span> sudo tee <span class="token operator">/</span>etc<span class="token operator">/</span>apt<span class="token operator">/</span>sources<span class="token punctuation">.</span>list<span class="token punctuation">.</span>d<span class="token operator">/</span>docker<span class="token punctuation">.</span>list <span class="token operator">&gt;</span> <span class="token operator">/</span>dev<span class="token operator">/</span>null
</code></pre></div><ul><li>\u5B89\u88C5 docker \u5F15\u64CE</li></ul><div class="language-go"><pre><code>sudo apt<span class="token operator">-</span>get install docker<span class="token operator">-</span>ce docker<span class="token operator">-</span>ce<span class="token operator">-</span>cli containerd<span class="token punctuation">.</span>io
</code></pre></div><ul><li>\u67E5\u770B\u5B58\u50A8\u5E93\u4E2D\u53EF\u7528\u7684\u7248\u672C</li></ul><div class="language-go"><pre><code>apt<span class="token operator">-</span>cache madison docker<span class="token operator">-</span>ce
</code></pre></div><ul><li>\u5B89\u88C5\u6307\u5B9A\u7248\u672C\u7684\u5F15\u64CE</li></ul><div class="language-go"><pre><code>sudo apt<span class="token operator">-</span>get install docker<span class="token operator">-</span>ce<span class="token operator">=</span><span class="token operator">&lt;</span>VERSION_STRING<span class="token operator">&gt;</span> docker<span class="token operator">-</span>ce<span class="token operator">-</span>cli<span class="token operator">=</span><span class="token operator">&lt;</span>VERSION_STRING<span class="token operator">&gt;</span> containerd<span class="token punctuation">.</span>io
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">\u8BF4\u660E</p><p>\u4F7F\u7528\u7B2C\u4E03\u6B65\u4E2D\u7684\u7248\u672C\u5B57\u7B26\u4E32\u5B89\u88C5\u7279\u5B9A\u7248\u672C\uFF0C\u4F8B\u5982 5:18.09.1~3-0~ubuntu-xenial</p></div><ul><li>\u5378\u8F7D docker \u5F15\u64CE</li></ul><div class="language-go"><pre><code>sudo apt<span class="token operator">-</span>get purge docker<span class="token operator">-</span>ce docker<span class="token operator">-</span>ce<span class="token operator">-</span>cli containerd<span class="token punctuation">.</span>io
</code></pre></div><ul><li>\u4E3B\u673A\u4E0A\u7684\u6620\u50CF\u3001\u5BB9\u5668\u3001\u5377\u6216\u81EA\u5B9A\u4E49\u914D\u7F6E\u6587\u4EF6\u4E0D\u4F1A\u81EA\u52A8\u5220\u9664\u3002\u8981\u5220\u9664\u6240\u6709\u6620\u50CF\u3001\u5BB9\u5668\u548C\u5377</li></ul><div class="language-go"><pre><code>sudo rm <span class="token operator">-</span>rf <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>docker <span class="token operator">&amp;&amp;</span> sudo rm <span class="token operator">-</span>rf <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>containerd
</code></pre></div><ul><li>\u6D4B\u8BD5\u662F\u5426\u5B89\u88C5\u5B8C\u6210</li></ul><div class="language-go"><pre><code>sudo docker run hello<span class="token operator">-</span>world
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">\u8BF4\u660E</p><p>\u8FD9\u91CC\u53EF\u80FD\u4F1A\u63D0\u793A\u4F60\u767B\u5F55</p></div><ul><li>\u767B\u5F55</li></ul><div class="language-go"><pre><code> docker login
</code></pre></div><ul><li>\u5B89\u88C5\u7A33\u5B9A\u7248\u7684 docker-compose</li></ul><div class="language-go"><pre><code>sudo curl <span class="token operator">-</span>L <span class="token string">&quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)&quot;</span> <span class="token operator">-</span>o <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span class="token operator">/</span>docker<span class="token operator">-</span>compose
</code></pre></div><ul><li>\u7ED9 <code>docker-compose</code> \u6DFB\u52A0\u6267\u884C\u6743\u9650</li></ul><div class="language-go"><pre><code>sudo chmod <span class="token operator">+</span>x <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span class="token operator">/</span>docker<span class="token operator">-</span>compose
</code></pre></div><h2 id="\u4E8C\u4E36\u5E38\u7528\u547D\u4EE4" tabindex="-1">\u4E8C\u4E36\u5E38\u7528\u547D\u4EE4 <a class="header-anchor" href="#\u4E8C\u4E36\u5E38\u7528\u547D\u4EE4" aria-hidden="true">#</a></h2><ul><li>\u6784\u5EFA\u73AF\u5883</li></ul><p><code>docker-compose up</code></p><ul><li><p>\u540E\u53F0\u8FD0\u884C <code>docker-compose up -d</code></p></li><li><p>\u67E5\u770B\u5F53\u524D\u5BB9\u5668\u8FD0\u884C\u72B6\u6001 <code>docker-compose ps</code></p></li><li><p>\u67E5\u770B\u5F53\u524D\u8FD0\u884C\u7684 web \u73AF\u5883 <code>docker-compose run web env</code></p></li><li><p>\u505C\u6B62\u5F53\u524D\u5BB9\u5668 <code>docker-compose stop</code></p></li><li><p>\u5C06\u6240\u6709\u5185\u5BB9\u90FD\u5173\u95ED\uFF0C\u5B8C\u5168\u5220\u9664\u5BB9\u5668 down \u3002\u4F20\u9012--volumes \u4E5F\u5220\u9664 Redis \u5BB9\u5668\u4F7F\u7528\u7684\u6570\u636E\u5377 <code>docker-compose down \u2014volumes</code></p></li><li><p>\u8FDB\u5165\u5BB9\u5668\u91CC\u9762\u67E5\u770B <code>docker exec -it docker_web_1 sh</code></p></li></ul><div class="tip custom-block"><p class="custom-block-title">\u8BF4\u660E</p><p>\u6709\u4E9B\u662F/bin/bash \u6709\u4E9B\u662F sh</p></div><ul><li>\u5220\u9664\u67D0\u4E2A\u5BB9\u5668 <code>docker rm \u5BB9\u5668 id</code></li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u53EF\u4EE5\u4F7F\u7528 docker ps -a \u67E5\u770B</p></div><ul><li>\u5220\u9664\u67D0\u4E2A\u955C\u50CF <code>docker rmi \u955C\u50CF id</code></li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u53EF\u4EE5\u4F7F\u7528 docker images \u67E5\u770B</p></div><ul><li>\u4ECE\u6307\u5B9A image \u91CC\u751F\u6210\u4E00\u4E2A container \u5E76\u5728\u5176\u4E2D\u8FD0\u884C\u4E00\u4E2A\u547D\u4EE4</li></ul><div class="language-go"><pre><code>docker run

    <span class="token operator">-</span>d <span class="token punctuation">:</span> \u5728\u540E\u53F0\u8FD0\u884C
    \u2013p <span class="token punctuation">:</span> \u6620\u5C04\u597D\u5185\u5916\u7AEF\u53E3<span class="token punctuation">,</span>
    <span class="token operator">--</span>name <span class="token punctuation">:</span> \u5728\u5BB9\u5668\u65F6\u7684\u540D\u79F0
    <span class="token operator">-</span>v <span class="token char">&#39;pwd&#39;</span> <span class="token punctuation">:</span> <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html <span class="token operator">-</span><span class="token operator">&gt;</span> \u628A\u8FD0\u884C\u5BB9\u5668\u7684\u5F53\u524D\u76EE\u5F55\u6620\u5C04\u5230<span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html
</code></pre></div><ul><li>\u8FDB\u5165\u5BB9\u5668\u7EC8\u7AEF</li></ul><div class="language-go"><pre><code><span class="token comment">// \u8FD9\u4E2A\u4F7F\u7528 exit \u9000\u51FA\uFF0C\u5BB9\u5668\u4F9D\u7136\u8FD0\u884C</span>
docker exec <span class="token operator">-</span>it containerId bash 

<span class="token comment">// \u4F7F\u7528 exit \u9000\u51FA\uFF0C\u5BB9\u5668\u4E5F\u4F1A\u505C\u6B62\uFF0C\u4F7F\u7528 ctrl + q \u6216\u8005 ctrl + p \u9000\u51FA</span>
docker attach containerId
</code></pre></div><ul><li>\u67E5\u770B\u5BB9\u5668\u8FD0\u884C\u7684 log \u65E5\u5FD7</li></ul><div class="language-go"><pre><code><span class="token comment">// \u67E5\u770B\u6240\u6709\u65E5\u5FD7\uFF0C\u6709\u70B9\u50CF cat \u547D\u4EE4</span>
docker logs containerId

<span class="token comment">// \u67E5\u770B\u5BB9\u5668\u8FD0\u884C\u7684\u5B9E\u65F6\u65E5\u5FD7\u76F8\u5F53\u4E8E tail -f</span>
docker logs <span class="token operator">-</span>f containerId 
</code></pre></div><ul><li>\u5C06\u5BB9\u5668\u91CC\u9762\u7684\u5185\u5BB9\u62F7\u8D1D\u51FA\u5BBF\u4E3B\u673A\u4E0A</li></ul><div class="language-go"><pre><code>docker cp b7845<span class="token punctuation">:</span><span class="token operator">/</span>home<span class="token operator">/</span>test<span class="token punctuation">.</span>java <span class="token operator">/</span>home

example<span class="token punctuation">:</span> docker cp a6e930134023<span class="token punctuation">:</span><span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token operator">/</span>index<span class="token punctuation">.</span>html <span class="token punctuation">.</span><span class="token operator">/</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">notice</p><p>a6e930134023 -&gt; \u5BB9\u5668 id /usr/share/nginx/html/index.html -&gt; \u5BB9\u5668\u6587\u4EF6 ./ -&gt; \u5BBF\u4E3B\u673A\u5730\u5740</p></div><h2 id="\u4E09\u4E36dockerfile-\u76F8\u5173\u64CD\u4F5C" tabindex="-1">\u4E09\u4E36Dockerfile \u76F8\u5173\u64CD\u4F5C <a class="header-anchor" href="#\u4E09\u4E36dockerfile-\u76F8\u5173\u64CD\u4F5C" aria-hidden="true">#</a></h2><ul><li>FROM</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u57FA\u7840\u955C\u50CF, \u4E00\u5207\u4ECE\u8FD9\u91CC\u5F00\u59CB\u6784\u5EFA \u6307\u5B9A\u54EA\u79CD\u955C\u50CF\u4F5C\u4E3A\u65B0\u955C\u50CF\u7684\u57FA\u7840\u955C\u50CF</p></div><p><code>FROM ubuntu:14.04</code></p><ul><li>MANTAINER</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u955C\u50CF\u662F\u8C01\u5199\u7684, \u59D3\u540D+\u90AE\u7BB1 \u6307\u660E\u8BE5\u955C\u50CF\u7684\u4F5C\u8005\u548C\u5176\u7535\u5B50\u90AE\u4EF6</p></div><p><code>LABEL maintainer=&quot;zzj123 &lt;1844066417@qq.com&gt;&quot; version=&quot;1.0&quot; app.name=&quot;Marketing sms&quot;</code></p><ul><li>RUN</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u955C\u50CF\u6784\u5EFA\u7684\u65F6\u5019\u9700\u8981\u8FD0\u884C\u7684\u547D\u4EE4\uFF0C\u5728\u65B0\u955C\u50CF\u5185\u90E8\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982\u5B89\u88C5\u4E00\u4E9B\u8F6F\u4EF6\u3001\u914D\u7F6E\u4E00\u4E9B\u57FA\u7840\u73AF\u5883\uFF0C\u53EF\u4F7F\u7528\\\u6765\u6362\u884C</p></div><div class="language-go"><pre><code>
RUN echo \u201Chello world\u201D \\

<span class="token comment">// = \u4E24\u8FB9\u5FC5\u987B\u52A0\u4E0A\u7A7A\u683C\uFF0C\u5426\u5219\u65E0\u6CD5\u5B9E\u73B0\u5224\u65AD\u903B\u8F91\uFF0Cdocker build\u4E0D\u4F1A\u62A5\u9519\uFF0C\u4F46\u662F\u4E00\u76F4\u4F1A\u8D70then\u540E\u9762\u7684\u903B\u8F91</span>
<span class="token comment">// tee\u662F\u76F4\u63A5\u5C06\u8F93\u51FA\u7684\u6240\u6709\u547D\u4EE4\u6216\u8005\u8BED\u53E5\u5199\u5165\u5230\u6587\u4EF6\u91CC\u9762</span>
<span class="token comment">// &gt; \u4E5F\u53EF\u4EE5\u5199\u5165\u6587\u4EF6\uFF0C\u4F46\u662F\u53EA\u80FD\u5199\u4E00\u884C\uFF0C\u5982\u679C\u5199\u591A\u4E2A\u540E\u9762\u7684\u4F1A\u8986\u76D6\u524D\u9762\u7684\u8BED\u53E5</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;\${APP_ENV}&quot;</span> <span class="token operator">!=</span> <span class="token char">&#39;prod&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> then <span class="token punctuation">{</span> \\
        echo <span class="token string">&quot;extension=skywalking.so&quot;</span><span class="token punctuation">;</span> \\
        echo <span class="token string">&quot;skywalking.app_code=$APP_CODE&quot;</span><span class="token punctuation">;</span> \\
        echo <span class="token string">&quot;skywalking.enable=1&quot;</span><span class="token punctuation">;</span> \\
        echo <span class="token string">&quot;skywalking.version=8&quot;</span><span class="token punctuation">;</span> \\
        echo <span class="token string">&quot;skywalking.error_handler_enable = 0&quot;</span><span class="token punctuation">;</span> \\
        echo <span class="token string">&quot;skywalking.grpc=$GRPC&quot;</span><span class="token punctuation">;</span> \\
        echo <span class="token string">&quot;skywalking.sample_n_per_3_secs = -1&quot;</span><span class="token punctuation">;</span> \\
        echo &#39;skywalking<span class="token punctuation">.</span>instance_name <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>&#39;<span class="token punctuation">;</span> \\
    <span class="token punctuation">}</span> <span class="token operator">|</span> tee <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>etc<span class="token operator">/</span>php<span class="token operator">/</span>conf<span class="token punctuation">.</span>d<span class="token operator">/</span>skywalking<span class="token punctuation">.</span>ini<span class="token punctuation">;</span> fi

<span class="token comment">// \u4E5F\u53EF\u4EE5\u4F7F\u7528exec\u683C\u5F0FRUN [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;]\u7684\u547D\u4EE4 </span>
RUN <span class="token punctuation">[</span>\u201Cyum\u201D<span class="token punctuation">,</span> \u201Cinstall\u201D<span class="token punctuation">,</span> \u201C<span class="token operator">-</span>y\u201D<span class="token punctuation">,</span> \u201Cnginx\u201D<span class="token punctuation">]</span>
<span class="token comment">// \u751F\u6210\u7684\u547D\u4EE4\uFF08linux\u4E0B\u547D\u4EE4\uFF09</span>
yum install <span class="token operator">-</span>y nginx
</code></pre></div><ul><li>ADD</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u6B65\u9AA4, <code>tomcat</code> \u955C\u50CF,\u538B\u7F29\u5305! \u6DFB\u52A0\u5185\u5BB9\uFF0C\u5C06\u4E3B\u673A\u7684\u6587\u4EF6\u590D\u5236\u5230\u955C\u50CF\u4E2D\uFF0C\u8DDF <code>COPY</code> \u4E00\u6837\uFF0C\u9650\u5236\u6761\u4EF6\u548C\u4F7F\u7528\u65B9\u5F0F\u90FD\u4E00\u6837</p></div><p><code>ADD ./index.tat.gz /usr/share/nginx/html/</code></p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>ADD \u4F1A\u5BF9\u538B\u7F29\u6587\u4EF6\uFF08<code>tar</code>, <code>gzip</code>, <code>bzip2</code>, <code>etc</code>\uFF09\u505A\u63D0\u53D6\u548C\u89E3\u538B\u64CD\u4F5C</p></div><ul><li>WORKDIR</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u955C\u50CF\u7684\u5DE5\u4F5C\u76EE\u5F55\uFF0C\u5728\u6784\u5EFA\u955C\u50CF\u65F6\uFF0C\u6307\u5B9A\u955C\u50CF\u7684\u5DE5\u4F5C\u76EE\u5F55\uFF0C\u4E4B\u540E\u7684\u547D\u4EE4\u90FD\u662F\u57FA\u4E8E\u6B64\u5DE5\u4F5C\u76EE\u5F55\uFF0C\u5982\u679C\u4E0D\u5B58\u5728\uFF0C\u5219\u4F1A\u521B\u5EFA\u76EE\u5F55</p></div><div class="language-go"><pre><code><span class="token comment">// docker exec -it \u8FDB\u5165\u7684\u76EE\u5F55\u5C31\u662F\u8FD9\u4E2A\u5DE5\u4F5C\u76EE\u5F55</span>
WORKDIR <span class="token operator">/</span>usr<span class="token operator">/</span>local
WORKDIR workspace \u6700\u7EC8\u7684\u5DE5\u4F5C\u76EE\u5F55\u662F<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>workspace
</code></pre></div><ul><li>VOLUME</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u6302\u8F7D\u7684\u76EE\u5F55\uFF0C\u7528\u6765\u5411\u57FA\u4E8E\u955C\u50CF\u521B\u5EFA\u7684\u5BB9\u5668\u6DFB\u52A0\u5377\u3002\u6BD4\u5982\u4F60\u53EF\u4EE5\u5C06 <code>mongodb</code> \u955C\u50CF\u4E2D\u5B58\u50A8\u6570\u636E\u7684 <code>data</code> \u6587\u4EF6\u6307\u5B9A\u4E3A\u4E3B\u673A\u7684\u67D0\u4E2A\u6587\u4EF6\u3002(\u5BB9\u5668\u5185\u90E8\u5EFA\u8BAE\u4E0D\u8981\u5B58\u50A8\u4EFB\u4F55\u6570\u636E)\u3002</p></div><div class="language-go"><pre><code>VOLUME <span class="token operator">/</span>data<span class="token operator">/</span>db <span class="token operator">/</span>data<span class="token operator">/</span>configdb
</code></pre></div><ul><li>EXPOSE</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u66B4\u9732\u7AEF\u53E3\u914D\u7F6E\uFF0C\u66B4\u9732\u955C\u50CF\u7684\u7AEF\u53E3\u4F9B\u4E3B\u673A\u505A\u6620\u5C04\uFF0C\u542F\u52A8\u955C\u50CF\u65F6\uFF0C\u4F7F\u7528-P \u53C2\u6570\u6765\u5C06\u955C\u50CF\u7AEF\u53E3\u4E0E\u5BBF\u4E3B\u673A\u7684\u968F\u673A\u7AEF\u53E3\u505A\u6620\u5C04,\u53EF\u6307\u5B9A\u591A\u4E2A</p></div><div class="language-go"><pre><code>EXPOSE <span class="token number">9601</span>
EXPOSE <span class="token number">9604</span>
</code></pre></div><ul><li>CMD</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u6307\u5B9A\u8FD9\u4E2A\u5BB9\u5668\u542F\u52A8\u7684\u65F6\u5019\u8981\u8FD0\u884C\u7684\u547D\u4EE4,\u53EA\u6709\u6700\u540E\u4E00\u4E2A\u4F1A\u751F\u6548,\u53EF\u88AB\u66FF\u4EE3\uFF0C\u5F53\u6709\u591A\u4E2A CMD \u7684\u65F6\u5019\uFF0C\u53EA\u6709\u6700\u540E\u4E00\u4E2A\u751F\u6548</p></div><div class="language-go"><pre><code><span class="token comment">// \u5BB9\u5668\u542F\u52A8\u65F6\u9700\u8981\u6267\u884C\u7684\u547D\u4EE4</span>
CMD <span class="token operator">/</span>bin<span class="token operator">/</span>bash
CMD <span class="token punctuation">[</span>\u201C<span class="token operator">/</span>bin<span class="token operator">/</span>bash\u201D<span class="token punctuation">]</span>
</code></pre></div><ul><li>ENTRYPOINT</li></ul><div class="warning custom-block"><p class="custom-block-title">notice</p><p>\u6307\u5B9A\u8FD9\u4E2A\u5BB9\u5668\u542F\u52A8\u7684\u65F6\u5019\u8981\u8FD0\u884C\u7684\u547D\u4EE4,\u53EF\u4EE5\u8FFD\u52A0\u547D\u4EE4 ENTRYPOINT \u4F5C\u7528\u548C\u7528\u6CD5\u548C CMD \u4E00\u6A21\u4E00\u6837\uFF0C\u533A\u522B\uFF1A a. CMD \u7684\u547D\u4EE4\u4F1A\u88AB docker run \u7684\u547D\u4EE4\u8986\u76D6\u800C ENTRYPOINT \u4E0D\u4F1A b. CMD \u548C ENTRYPOINT \u90FD\u5B58\u5728\u65F6\uFF0CCMD \u7684\u6307\u4EE4\u53D8\u6210\u4E86 ENTRYPOINT \u7684\u53C2\u6570\uFF0C\u5E76\u4E14\u6B64 CMD \u63D0\u4F9B\u7684\u53C2\u6570\u4F1A\u88AB docker run \u540E\u9762\u7684\u547D\u4EE4\u8986\u76D6</p></div><div class="language-go"><pre><code>ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;php&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/var/www/html/bin/hyperf.php&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;start&quot;</span><span class="token punctuation">]</span>

<span class="token comment">// \u53EF\u4EE5\u5728docker.yml\u6587\u4EF6\u91CC\u9762\u5199\u591A\u6761\u547D\u4EE4</span>
entrypoint<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;sh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;php /var/www/html/bin/hyperf.php migrate &amp;&amp; php /var/www/html/bin/hyperf.php start&quot;</span><span class="token punctuation">]</span>
</code></pre></div><ul><li>ONBUILD</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u5F53\u6784\u5EFA\u4E00\u4E2A\u88AB\u7EE7\u627F DockerFile \u8FD9\u4E2A\u65F6\u5019\u5C31\u4F1A\u8FD0\u884C ONBUILD \u7684\u6307\u4EE4,\u89E6\u53D1\u6307\u4EE4 \u5F53\u4E00\u4E2A\u5305\u542B ONBUILD \u547D\u4EE4\u7684\u955C\u50CF\u88AB\u7528\u4F5C\u5176\u4ED6\u955C\u50CF\u7684\u57FA\u7840\u955C\u50CF\u65F6(\u6BD4\u5982\u7528\u6237\u7684\u955C\u50CF\u9700\u8981\u4ECE\u67D0\u4E3A\u51C6\u5907\u597D\u7684\u4F4D\u7F6E\u6DFB\u52A0\u6E90\u4EE3\u7801\uFF0C\u6216\u8005\u7528\u6237\u9700\u8981\u6267\u884C\u7279\u5B9A\u4E8E\u6784\u5EFA\u955C\u50CF\u7684\u73AF\u5883\u7684\u6784\u5EFA\u811A\u672C)\uFF0C\u8BE5\u547D\u4EE4\u5C31\u4F1A\u6267\u884C</p></div><p><code>ONBUILD ADD . /var/www</code></p><ul><li>USER</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u6307\u5B9A\u7528\u6237\uFF0C\u6307\u5B9A\u8BE5\u955C\u50CF\u4EE5\u4EC0\u4E48\u6837\u7684\u7528\u6237\u53BB\u6267\u884C</p></div><p><code>USER nginx</code></p><ul><li>COPY</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u7C7B\u4F3C ADD,\u5C06\u6211\u4EEC\u6587\u4EF6\u62F7\u8D1D\u5230\u955C\u50CF\u4E2D\uFF0C\u5C06\u4E3B\u673A\u7684\u6587\u4EF6\u590D\u5236\u5230\u955C\u50CF\u5185\uFF0C\u5982\u679C\u76EE\u7684\u4F4D\u7F6E\u4E0D\u5B58\u5728\uFF0CDocker \u4F1A\u81EA\u52A8\u521B\u5EFA\u6240\u6709\u9700\u8981\u7684\u76EE\u5F55\u7ED3\u6784\uFF0C\u4F46\u662F\u5B83\u53EA\u662F\u5355\u7EAF\u7684\u590D\u5236\uFF0C\u5E76\u4E0D\u4F1A\u53BB\u505A\u6587\u4EF6\u63D0\u53D6\u548C\u89E3\u538B\u5DE5\u4F5C\u3002</p></div><p><code>COPY ./index.html /usr/share/nginx/html/index.html</code></p><div class="warning custom-block"><p class="custom-block-title">notice</p><p>\u6CE8\u610F\uFF1A\u9700\u8981\u590D\u5236\u7684\u76EE\u5F55\u4E00\u5B9A\u8981\u653E\u5728 Dockerfile \u6587\u4EF6\u7684\u540C\u7EA7\u76EE\u5F55\u4E0B \u539F\u56E0\uFF1A\u56E0\u4E3A\u6784\u5EFA\u73AF\u5883\u5C06\u4F1A\u4E0A\u4F20\u5230 Docker \u5B88\u62A4\u8FDB\u7A0B\uFF0C\u800C\u590D\u5236\u662F\u5728 Docker \u5B88\u62A4\u8FDB\u7A0B\u4E2D\u8FDB\u884C\u7684\u3002\u4EFB\u4F55\u4F4D\u4E8E\u6784\u5EFA\u73AF\u5883\u4E4B\u5916\u7684\u4E1C\u897F\u90FD\u662F\u4E0D\u53EF\u7528\u7684\u3002COPY \u6307\u4EE4\u7684\u76EE\u7684\u7684\u4F4D\u7F6E\u5219\u5FC5\u987B\u662F\u5BB9\u5668\u5185\u90E8\u7684\u4E00\u4E2A\u7EDD\u5BF9\u8DEF\u5F84</p></div><ul><li>ARG</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u53C2\u6570\uFF0C\u8FD9\u91CC\u9762\u7684\u53C2\u6570\u53EF\u4EE5\u83B7\u53D6\u5230docker build --build-arg arg=params\u91CC\u9762\u7684arg\u53C2\u6570</p></div><p><code>ARG arg</code></p><ul><li>ENV</li></ul><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u6784\u5EFA\u7684\u65F6\u5019\u8BBE\u7F6E\u73AF\u5883\u53D8\u91CF</p></div><div class="language-go"><pre><code>ENV TIMEZONE<span class="token operator">=</span>$<span class="token punctuation">{</span>timezone<span class="token punctuation">:</span><span class="token operator">-</span><span class="token string">&quot;Asia/Shanghai&quot;</span><span class="token punctuation">}</span> \\
    APP_ENV<span class="token operator">=</span>$<span class="token punctuation">{</span>appenv<span class="token punctuation">}</span> \\
    SCAN_CACHEABLE<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> \\
    APP_NAME<span class="token operator">=</span>$<span class="token punctuation">{</span>appname<span class="token punctuation">}</span> \\
    MSGPACK_VERSION<span class="token operator">=</span><span class="token char">&#39;2.1.2&#39;</span> \\
    YAR_VERSION<span class="token operator">=</span><span class="token char">&#39;2.2.0&#39;</span> \\
    RDKAFKA_VERSION<span class="token operator">=</span><span class="token char">&#39;6.0.1&#39;</span> \\
    # \u914D\u7F6Eskywalking\u73AF\u5883\u53D8\u91CF
    APP_CODE<span class="token operator">=</span><span class="token string">&quot;hello_skywalking&quot;</span> \\
    GRPC<span class="token operator">=</span><span class="token string">&quot;192.168.150.205:11800&quot;</span>
</code></pre></div><h2 id="\u56DB\u4E36\u6784\u5EFA\u9879\u76EE" tabindex="-1">\u56DB\u4E36\u6784\u5EFA\u9879\u76EE <a class="header-anchor" href="#\u56DB\u4E36\u6784\u5EFA\u9879\u76EE" aria-hidden="true">#</a></h2><ul><li>\u4F7F\u7528\u5F53\u524D\u76EE\u5F55\u7684 Dockerfile \u521B\u5EFA\u955C\u50CF\uFF0C\u6807\u7B7E\u4E3A runoob/ubuntu:v1\u3002</li></ul><div class="language-go"><pre><code>docker build <span class="token operator">-</span>t runoob<span class="token operator">/</span>ubuntu<span class="token punctuation">:</span>v1 <span class="token punctuation">.</span>
</code></pre></div><ul><li>\u4F7F\u7528 URL <a href="http://github.com/creack/docker-firefox" target="_blank" rel="noopener noreferrer">github.com/creack/docker-firefox</a> \u7684 Dockerfile \u521B\u5EFA\u955C\u50CF\u3002</li></ul><div class="language-go"><pre><code>docker build github<span class="token punctuation">.</span>com<span class="token operator">/</span>creack<span class="token operator">/</span>docker<span class="token operator">-</span>firefox
</code></pre></div><ul><li>\u901A\u8FC7 -f Dockerfile \u6587\u4EF6\u7684\u4F4D\u7F6E</li></ul><div class="language-go"><pre><code>docker build <span class="token operator">-</span>f <span class="token operator">/</span>path<span class="token operator">/</span>to<span class="token operator">/</span>a<span class="token operator">/</span>Dockerfile <span class="token punctuation">.</span>
</code></pre></div><ul><li>\u5728 Docker \u5B88\u62A4\u8FDB\u7A0B\u6267\u884C Dockerfile \u4E2D\u7684\u6307\u4EE4\u524D\uFF0C\u9996\u5148\u4F1A\u5BF9 Dockerfile \u8FDB\u884C\u8BED\u6CD5\u68C0\u67E5\uFF0C\u6709\u8BED\u6CD5\u9519\u8BEF\u65F6\u4F1A\u8FD4\u56DE</li></ul><div class="language-go"><pre><code>docker build <span class="token operator">-</span>t test<span class="token operator">/</span>myapp <span class="token punctuation">.</span> 
</code></pre></div><ul><li>\u6574\u4E2A\u955C\u50CF\u6587\u4EF6\u64CD\u4F5C</li></ul><div class="language-go"><pre><code>cat alibaba<span class="token operator">-</span>rocketmq<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.6</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">|</span> docker <span class="token keyword">import</span> <span class="token operator">-</span> rocketmq<span class="token punctuation">:</span><span class="token number">3.2</span><span class="token punctuation">.</span><span class="token function">6</span><span class="token punctuation">(</span>\u955C\u50CF\u540D\u81EA\u5DF1\u5B9A\u4E49<span class="token punctuation">)</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">notice</p><p>docker \u5BFC\u5165\u672C\u5730\u955C\u50CF\uFF0C \u672C\u5730\u7684\u955C\u50CF\u5BFC\u5165\uFF0C\u4F7F\u7528 <code>docker import</code> \u547D\u4EE4\u3002 \u955C\u50CF\u6587\u4EF6\u5FC5\u987B\u662F <code>tar.gz</code> \u7C7B\u578B\u7684\u6587\u4EF6\u3002</p></div><div class="language-go"><pre><code>docker save <span class="token operator">-</span>o rocketmq<span class="token punctuation">.</span>tar rocketmq
docker save rocketmq <span class="token operator">&gt;</span> rocketmq<span class="token punctuation">.</span>tar
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">notice</p><p>-o\uFF1A\u6307\u5B9A\u4FDD\u5B58\u7684\u955C\u50CF\u7684\u540D\u5B57\uFF1B rocketmq.tar\uFF1A\u4FDD\u5B58\u5230\u672C\u5730\u7684\u955C\u50CF\u540D\u79F0\uFF1B rocketmq\uFF1A\u955C\u50CF\u540D\u5B57</p></div><div class="language-go"><pre><code>docker load <span class="token operator">--</span>input rocketmq<span class="token punctuation">.</span>tar
docker load <span class="token operator">&lt;</span> rocketmq<span class="token punctuation">.</span>tar
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">notice</p><p><code>docker load</code> \u5C06\u672C\u5730\u4FDD\u5B58\u7684\u955C\u50CF\u518D\u6B21\u5BFC\u5165 <code>docker</code> \u4E2D</p></div><h2 id="\u4E94\u4E36-\u955C\u50CF" tabindex="-1">\u4E94\u4E36 \u955C\u50CF <a class="header-anchor" href="#\u4E94\u4E36-\u955C\u50CF" aria-hidden="true">#</a></h2><ul><li>\u67E5\u770B\u955C\u50CF</li></ul><div class="language-go"><pre><code>docker images
</code></pre></div><ul><li>\u67E5\u770B\u6240\u6709\u955C\u50CF\u53EA\u663E\u793A containerId</li></ul><div class="language-go"><pre><code>docker image <span class="token operator">-</span>qa
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">notice</p><p><code>-a</code> \u663E\u793A\u6240\u6709 <code>-q</code> \u53EA\u663E\u793A <code>id</code></p></div><ul><li>\u5220\u9664\u955C\u50CF</li></ul><div class="language-go"><pre><code>docker rmi <span class="token operator">-</span>f containerId
</code></pre></div><ul><li>\u5220\u9664\u5168\u90E8\u955C\u50CF</li></ul><div class="language-go"><pre><code>docker rmi <span class="token operator">-</span>f $<span class="token punctuation">(</span>docker images <span class="token operator">-</span>qa<span class="token punctuation">)</span>
</code></pre></div><ul><li>pull \u955C\u50CF\u5E76\u8FD0\u884C</li></ul><div class="language-go"><pre><code>docker pull containerId
docker run <span class="token punctuation">[</span>\u53C2\u6570<span class="token punctuation">]</span> image
</code></pre></div><ul><li>\u5220\u9664\u6240\u6709\u7684\u5BB9\u5668</li></ul><div class="language-go"><pre><code>docker rmi <span class="token operator">-</span>f $<span class="token punctuation">(</span>docker ps <span class="token operator">-</span>qa<span class="token punctuation">)</span>
</code></pre></div><ul><li>\u5220\u9664\u6240\u6709\u7684\u5BB9\u5668</li></ul><div class="language-go"><pre><code>docker ps <span class="token operator">-</span>qa<span class="token operator">|</span>xargs docker rm
</code></pre></div><ul><li>\u5F00\u542F\u5BB9\u5668</li></ul><div class="language-go"><pre><code>docker start containerId
</code></pre></div><ul><li>\u505C\u6B62\u5BB9\u5668</li></ul><div class="language-go"><pre><code>docker stop containerId
</code></pre></div><ul><li>\u91CD\u542F\u5BB9\u5668</li></ul><div class="language-go"><pre><code>docker restart containerId
</code></pre></div><ul><li>\u6740\u6B7B\u5BB9\u5668</li></ul><div class="language-go"><pre><code>docker kill containerId
</code></pre></div><ul><li>\u5176\u4ED6\u91CD\u8981\u547D\u4EE4</li></ul><div class="language-go"><pre><code>docker run <span class="token operator">-</span>d centos <span class="token operator">/</span>bin<span class="token operator">/</span>bash <span class="token operator">-</span>c \u201C\u8FD9\u91CC\u53EF\u4EE5\u5199 sheel \u811A\u672C&quot;
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">notice</p><p>\u540E\u53F0\u542F\u52A8\u5BB9\u5668, \u4F46\u662F\u4F7F\u7528 <code>docker ps</code> \u662F\u770B\u4E0D\u5230\u8FD9\u4E2A\u5BB9\u5668\u7684 <code>centos</code> \u5DF2\u7ECF\u505C\u6B62\u4E86\u3002\u5BB9\u5668\u4F7F\u7528\u540E\u53F0\u8FD0\u884C\uFF0C\u5C31\u5FC5\u987B\u8981\u6709\u4E00\u4E2A\u524D\u53F0\u8FDB\u7A0B\uFF0C<code>docker</code> \u53D1\u73B0\u6CA1\u6709\u5E94\u7528\uFF0C\u5C31\u4F1A\u7ACB\u5373\u505C\u6B62\uFF0C\u6BD4\u5982\u8BF4\u542F\u52A8\u4E00\u4E2A <code>nginx</code> ,\u5BB9\u5668\u542F\u52A8\u4E4B\u540E\u53D1\u73B0\u81EA\u5DF1\u6CA1\u6709\u63D0\u4F9B\u670D\u52A1\uFF0C\u5C31\u4F1A\u7ACB\u5373\u505C\u6B62\uFF0C\u5C31\u662F\u6CA1\u6709\u7A0B\u5E8F\u4E86</p></div><ul><li>\u67E5\u770B\u5BB9\u5668\u65E5\u5FD7</li></ul><div class="language-go"><pre><code>docker logs <span class="token operator">-</span>f <span class="token operator">-</span>t \u2014tail <span class="token number">10</span> containerId
</code></pre></div><ul><li>\u67E5\u770B\u5BB9\u5668\u7684\u8FDB\u7A0B</li></ul><div class="language-go"><pre><code>docker top containerId
</code></pre></div><ul><li>\u67E5\u770B\u5BB9\u5668\u7684\u8BE6\u7EC6\u4FE1\u606F</li></ul><div class="language-go"><pre><code>docker inspect containerId
</code></pre></div><ul><li>\u8FDB\u5165\u5BB9\u5668\uFF0C<code>-it</code> \u4EE5\u4EA4\u4E92\u6A21\u5F0F\u8FDB\u5165</li></ul><div class="language-go"><pre><code><span class="token comment">// \u8FDB\u5165\u5BB9\u5668\uFF0C\u6709\u4E9B\u7CFB\u7EDF\u662F\u4F7F\u7528sh</span>
docker exec <span class="token operator">-</span>it containerId <span class="token operator">/</span>bin<span class="token operator">/</span>bash

\u4E5F\u662F\u8FDB\u5165\u5BB9\u5668
docker attach containerId
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">notice</p><p><code>exec</code> \u8FDB\u5165\u5BB9\u5668\u4F7F\u7528 <code>exit</code> \u9000\u51FA\u7684\u65F6\u5019\uFF0C\u5BB9\u5668\u4E0D\u4F1A\u505C\u6B62 <code>attach</code> \u8FDB\u5165\u5BB9\u5668\u4F7F\u7528 <code>exit</code> \u9000\u51FA\u7684\u65F6\u5019\uFF0C\u5BB9\u5668\u4F1A\u505C\u6B62</p></div><ul><li>\u62F7\u8D1D\u5BB9\u5668\u91CC\u9762\u7684\u6587\u4EF6\u5230\u5BBF\u4E3B\u673A</li></ul><div class="language-go"><pre><code>docker cp \u5BB9\u5668<span class="token punctuation">:</span>\u76EE\u5F55\u5730\u5740\u6587\u4EF6\u5730\u5740 \u5BBF\u4E3B\u673A\u5730\u5740
</code></pre></div><ul><li>\u7528\u4E8E\u6D4B\u8BD5,--rm \u7528\u5B8C\u5373\u5220</li></ul><div class="language-go"><pre><code>docker run <span class="token operator">-</span>it \u2014rm nginx
</code></pre></div><ul><li>\u5F00\u542F <code>docker remote api</code></li></ul><div class="language-go"><pre><code>vim <span class="token operator">/</span>lib<span class="token operator">/</span>systemd<span class="token operator">/</span>system<span class="token operator">/</span>docker<span class="token punctuation">.</span>service

ExecStart<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>dockerd <span class="token operator">-</span>H unix<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>docker<span class="token punctuation">.</span>sock <span class="token operator">-</span>H tcp<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">:</span><span class="token number">2375</span> <span class="token operator">-</span>H fd<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">--</span>containerd<span class="token operator">=</span><span class="token operator">/</span>run<span class="token operator">/</span>containerd<span class="token operator">/</span>containerd<span class="token punctuation">.</span>sock
</code></pre></div><ul><li>\u91CD\u542F</li></ul><div class="language-go"><pre><code>systemctl daemon<span class="token operator">-</span>reload
systemctl restart docker<span class="token punctuation">.</span>server
</code></pre></div><ul><li>\u67E5\u770B</li></ul><div class="language-go"><pre><code>sudo netstat <span class="token operator">-</span>lntp <span class="token operator">|</span> grep dockerd 
</code></pre></div><h2 id="\u4E94\u4E36docker-\u76F8\u5173\u95EE\u9898" tabindex="-1">\u4E94\u4E36docker \u76F8\u5173\u95EE\u9898 <a class="header-anchor" href="#\u4E94\u4E36docker-\u76F8\u5173\u95EE\u9898" aria-hidden="true">#</a></h2><ul><li>Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?</li></ul><div class="danger custom-block"><p class="custom-block-title">notice</p><p>\u56E0\u4E3A docker \u670D\u52A1\u6CA1\u6709\u542F\u52A8\uFF0C\u6240\u4EE5\u5728\u76F8\u5E94\u7684/var/run/ \u8DEF\u5F84\u4E0B\u627E\u4E0D\u5230 docker \u7684\u8FDB\u7A0B\u3002 \u89E3\u51B3\u65B9\u6848\uFF1Aservice docker start</p></div><ul><li>Docker \u5BB9\u5668\u542F\u52A8\u62A5 WARNING: IPv4 forwarding is disabled. Networking will not work</li></ul><div class="danger custom-block"><p class="custom-block-title">notice</p><p><code>network</code> \u6CA1\u6709\u5F00\u542F \u89E3\u51B3\u65B9\u6848\uFF1A<code>vim /etc/sysctl.conf</code> \u6216\u8005 <code>vi /usr/lib/sysctl.d/00-system.conf</code> \u6DFB\u52A0\uFF1A <code>net.ipv4.ip_forward=1</code> \u91CD\u542F\uFF1A<code>systemctl restart network | centos8 -&gt; nmcli c reload</code> \u4F7F\u914D\u7F6E\u7ACB\u5373\u751F\u6548\uFF1A <code>sysctl -p</code></p></div><ul><li>\u5B89\u88C5 composer</li></ul><div class="language-go"><pre><code><span class="token comment">// \u4E0B\u8F7Dcomposer\u5305\u5E76\u4E14\u653E\u5728 /usr/local/bin/composer \u4E0B\u9762</span>
wget https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>getcomposer<span class="token punctuation">.</span>org<span class="token operator">/</span>download<span class="token operator">/</span><span class="token number">2.0</span><span class="token number">.2</span><span class="token operator">/</span>composer<span class="token punctuation">.</span>phar <span class="token operator">-</span>O <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span class="token operator">/</span>composer

<span class="token comment">// \u7ED9 \`composer\` \u4E8C\u8FDB\u5236\u5305\u6DFB\u52A0\u6267\u884C\u6743\u9650</span>
chmod <span class="token operator">+</span>x <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span class="token operator">/</span>composer 
</code></pre></div><ul><li>docker \u8FD0\u884C\u7684\u65E5\u5FD7\u53EF\u80FD\u4F1A\u5360\u6EE1\u6574\u4E2A\u670D\u52A1\u5668</li></ul><div class="danger custom-block"><p class="custom-block-title">notice</p><ol><li><p>\u67E5\u8BE2\u5F53\u524D\u76EE\u5F55\u7684\u78C1\u76D8\u5360\u7528\u60C5\u51B5 <code>du -h \u2014-max-depth=1</code></p></li><li><p>\u66F4\u6539 <code>docker-compose</code> \u7684\u914D\u7F6E\u6587\u4EF6 <code>yml</code></p></li></ol><div class="language-go"><pre><code>logging<span class="token punctuation">:</span>
   options<span class="token punctuation">:</span>
   max<span class="token operator">-</span>size<span class="token punctuation">:</span> <span class="token char">&#39;1G&#39;</span>
   max<span class="token operator">-</span>file<span class="token punctuation">:</span> <span class="token char">&#39;5&#39;</span>
   driver<span class="token punctuation">:</span> json<span class="token operator">-</span>file
</code></pre></div></div><ul><li>\u6839\u636E\u5BB9\u5668\u540D\u79F0\u67E5\u8BE2\u5BB9\u5668 ID \u5E76\u5220\u9664</li></ul><div class="language-go"><pre><code><span class="token comment">// \u7B2C\u4E00\u79CD\u5199\u6CD5</span>
docker stop <span class="token string">\`docker ps -a| grep test-project | awk &#39;{print $1}&#39; \`</span>
docker rm <span class="token string">\`docker ps -a| grep test-project | awk &#39;{print $1}&#39; \`</span>

<span class="token comment">// \u7B2C\u4E8C\u79CD\u5199\u6CD5</span>

docker stop <span class="token string">\`docker ps -aq --filter name=test-project\`</span>
docker rm <span class="token string">\`docker ps -aq --filter name=test-project\`</span>
</code></pre></div><ul><li>\u6839\u636E\u955C\u50CF\u540D\u79F0\u67E5\u8BE2\u5BB9\u5668 ID \u5E76\u5220\u9664</li></ul><div class="language-go"><pre><code><span class="token comment">// \u7B2C\u4E00\u79CD\u5199\u6CD5</span>

docker stop <span class="token string">\`docker ps -a| grep ygsama/test-project:1.0.2 | awk &#39;{print $1}&#39; \`</span>
docker rm <span class="token string">\`docker ps -a| grep ygsama/test-project:1.0.2 | awk &#39;{print $1}&#39; \`</span>

<span class="token comment">// \u7B2C\u4E8C\u79CD\u5199\u6CD5</span>

docker stop <span class="token string">\`docker ps -aq --filter ancestor=ygsama/test-project:1.0.2\`</span>
docker rm <span class="token string">\`docker ps -aq --filter ancestor=ygsama/test-project:1.0.2\`</span>
</code></pre></div><ul><li>\u6839\u636E\u955C\u50CF\u540D\u79F0\u67E5\u8BE2\u955C\u50CF ID \u5E76\u5220\u9664</li></ul><div class="language-go"><pre><code>docker images <span class="token operator">-</span>q <span class="token operator">--</span>filter reference<span class="token operator">=</span>ygsama<span class="token operator">/</span>test<span class="token operator">-</span>project<span class="token operator">*</span><span class="token punctuation">:</span><span class="token operator">*</span>

docker image rm <span class="token string">\`docker images -q --filter reference=10.2.21.95:10001/treasury-brain*:*\`</span>
</code></pre></div><ul><li>docker \u66F4\u6539 mysql \u5BC6\u7801</li></ul><div class="language-go"><pre><code><span class="token comment">// \u4FEE\u6539\u666E\u901A\u7528\u6237\uFF0C\u53EA\u6539\u4E00\u4E2A\u5C31\u597D</span>
SET PASSWORD FOR <span class="token char">&#39;youruser&#39;</span> <span class="token operator">=</span> <span class="token function">PASSWORD</span><span class="token punctuation">(</span><span class="token char">&#39;xxxxxxxx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u4FEE\u6539 root \u7528\u6237\uFF0C\u6539\u4E24\u4E2A</span>
SET PASSWORD FOR <span class="token char">&#39;root&#39;</span> <span class="token operator">=</span> <span class="token function">PASSWORD</span><span class="token punctuation">(</span><span class="token char">&#39;xxxxxxxxx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
SET PASSWORD FOR <span class="token char">&#39;root&#39;</span>@<span class="token char">&#39;localhost&#39;</span><span class="token operator">=</span><span class="token function">PASSWORD</span><span class="token punctuation">(</span><span class="token char">&#39;xxxxxxxxx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>\u67E5\u770Bdocker\u5185\u5B58\u4F7F\u7528\u60C5\u51B5</li></ul><div class="language-go"><pre><code>docker system df <span class="token operator">-</span>v
</code></pre></div>`,176);function d(a,u,g,m,v,b){return c(),o("div",null,[s("h1",r,[e(p(a.$frontmatter.title)+" ",1),i]),k])}var f=n(l,[["render",d]]);export{x as __pageData,f as default};
